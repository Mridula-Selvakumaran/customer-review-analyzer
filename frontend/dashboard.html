<!DOCTYPE html>
<html class="light" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Analysis Upload Dashboard</title>
<script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#135bec",
                        "background-light": "#f6f6f8",
                        "background-dark": "#101622",
                    },
                    fontFamily: {
                        "display": ["Lexend", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.25rem",
                        "lg": "0.5rem",
                        "xl": "0.75rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
<style>
        body {
            font-family: 'Lexend', sans-serif;
        }
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        .bg-gradient-primary {
            background: linear-gradient(135deg, #135bec 0%, #7c3aed 100%);
        }
        .file-selected {
            border-color: #135bec !important;
            background-color: rgba(19, 91, 236, 0.1) !important;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark min-h-screen flex flex-col font-display transition-colors duration-200">
<!-- Header / TopNavBar -->
<header class="fixed top-0 left-0 right-0 z-50 bg-white dark:bg-background-dark border-b border-primary/20 px-6 lg:px-20 h-16 flex items-center justify-between">
<div class="flex items-center gap-3">
<div class="size-8 bg-primary rounded-lg flex items-center justify-center text-white">
<span class="material-symbols-outlined text-xl">analytics</span>
</div>
<h2 class="text-primary dark:text-white text-xl font-bold tracking-tight">Customer Review Analyzer</h2>
</div>
<div class="flex items-center gap-4">
<div class="hidden sm:flex flex-col items-end">
<span class="text-sm font-medium text-slate-700 dark:text-slate-200">ABC XYZ</span>
<span class="text-xs text-slate-400">XYZ Corporation</span>
</div>
<div class="size-10 rounded-full border-2 border-primary/10 overflow-hidden bg-slate-100 dark:bg-slate-800 flex items-center justify-center">
<span class="material-symbols-outlined text-slate-500 dark:text-slate-400">person</span>
</div>
</div>
</header>
<!-- Main Content Container -->
<main class="flex-grow flex flex-col items-center justify-center px-4 pt-24 pb-12">
<div class="max-w-[800px] w-full flex flex-col items-center">
<!-- Headline Section -->
<div class="text-center mb-10">
<h1 class="text-slate-900 dark:text-white tracking-tight text-3xl md:text-4xl font-bold leading-tight mb-4">
                    Customer Review Summarizer
                </h1>
<p class="text-slate-500 dark:text-slate-400 text-lg font-normal max-w-xl mx-auto">
                    Upload customer reviews to automatically extract aspect-wise pros and cons using our AI model.
                </p>
</div>
<!-- Upload Area / EmptyState -->
<div class="w-full bg-white dark:bg-slate-900/50 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 p-8">
<div id="dropzone" class="flex flex-col items-center gap-8 rounded-xl border-2 border-dashed border-primary/30 dark:border-primary/20 bg-primary/5 dark:bg-primary/5 px-6 py-16 transition-all hover:border-primary/50 group cursor-pointer">
<div class="size-20 bg-primary/10 rounded-full flex items-center justify-center text-primary mb-2 group-hover:scale-110 transition-transform">
<span class="material-symbols-outlined text-4xl" style="font-variation-settings: 'wght' 300;">cloud_upload</span>
</div>
<div class="flex flex-col items-center gap-3 text-center">
<p class="text-slate-800 dark:text-white text-xl font-semibold tracking-tight">
                            Drag and drop your review file here or <span class="text-primary underline decoration-primary/30 underline-offset-4">click to browse</span>
</p>
<div class="flex items-center gap-2 text-slate-400 text-sm bg-white dark:bg-slate-800 px-3 py-1 rounded-full border border-slate-100 dark:border-slate-700">
<span class="material-symbols-outlined text-sm">description</span>
<span>Accepted formats: .csv, .xlsx</span>
</div>
</div>
<!-- Hidden file input -->
<input accept=".csv,.xlsx" class="hidden" id="fileInput" type="file"/>
</div>

<!-- Selected File Display -->
<div id="fileInfo" class="hidden mt-4 p-4 bg-primary/5 border border-primary/20 rounded-lg">
<div class="flex items-center justify-between">
<div class="flex items-center gap-3">
<span class="material-symbols-outlined text-primary">description</span>
<div>
<p id="fileName" class="text-sm font-semibold text-slate-800 dark:text-slate-200"></p>
<p id="fileSize" class="text-xs text-slate-500"></p>
</div>
</div>
<button id="removeFile" class="text-slate-400 hover:text-red-500 transition-colors">
<span class="material-symbols-outlined">close</span>
</button>
</div>
</div>

<!-- Action Button / SingleButton -->
<div class="mt-8 flex flex-col items-center gap-4">
<button id="analyzeBtn" disabled class="w-full md:w-auto min-w-[260px] h-14 flex items-center justify-center gap-3 bg-gradient-primary text-white text-lg font-bold rounded-lg shadow-lg shadow-primary/20 hover:shadow-xl hover:shadow-primary/30 transition-all active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:shadow-lg">
<span class="truncate">Upload and Analyze</span>
<span class="material-symbols-outlined">bolt</span>
</button>
<p class="text-xs text-slate-400 dark:text-slate-500 flex items-center gap-1">
<span class="material-symbols-outlined text-xs">verified_user</span>
                        Your data is processed securely
                    </p>
</div>
</div>
<!-- Features Quick Look -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-16 w-full">
<div class="flex flex-col items-center text-center p-4">
<span class="material-symbols-outlined text-primary mb-2">sentiment_satisfied</span>
<h3 class="font-bold text-slate-800 dark:text-slate-200 text-sm mb-1">Sentiment Analysis</h3>
<p class="text-xs text-slate-500">Extract emotional tone across different product aspects.</p>
</div>
<div class="flex flex-col items-center text-center p-4 border-x border-slate-200 dark:border-slate-800">
<span class="material-symbols-outlined text-primary mb-2">auto_awesome</span>
<h3 class="font-bold text-slate-800 dark:text-slate-200 text-sm mb-1">AI Summarization</h3>
<p class="text-xs text-slate-500">Condense thousands of reviews into concise pro/con lists.</p>
</div>
<div class="flex flex-col items-center text-center p-4">
<span class="material-symbols-outlined text-primary mb-2">insights</span>
<h3 class="font-bold text-slate-800 dark:text-slate-200 text-sm mb-1">Trend Detection</h3>
<p class="text-xs text-slate-500">Identify emerging issues before they impact your brand.</p>
</div>
</div>
</div>
</main>
<!-- Footer -->
<footer class="py-10 border-t border-slate-200 dark:border-slate-800 text-center">
<p class="text-slate-400 text-sm font-normal">
            © 2026 Customer Review Analyzer · AI-powered review analysis
</p>
<div class="mt-4 flex justify-center gap-6 opacity-30 grayscale hover:grayscale-0 hover:opacity-100 transition-all duration-300">
<div class="size-6 bg-slate-400 rounded-sm" data-alt="University affiliation logo abstract"></div>
<div class="size-6 bg-slate-400 rounded-sm" data-alt="Research institute logo abstract"></div>
<div class="size-6 bg-slate-400 rounded-sm" data-alt="SaaS compliance badge abstract"></div>
</div>
</footer>

<script>
    // Get DOM elements
    const dropzone = document.getElementById('dropzone');
    const fileInput = document.getElementById('fileInput');
    const fileInfo = document.getElementById('fileInfo');
    const fileName = document.getElementById('fileName');
    const fileSize = document.getElementById('fileSize');
    const removeFileBtn = document.getElementById('removeFile');
    const analyzeBtn = document.getElementById('analyzeBtn');
    
    let selectedFile = null;

    // Click to open file explorer
    dropzone.addEventListener('click', () => {
        fileInput.click();
    });

    // Handle file selection
    fileInput.addEventListener('change', (e) => {
        handleFile(e.target.files[0]);
    });

    // Drag and drop functionality
    dropzone.addEventListener('dragover', (e) => {
        e.preventDefault();
        dropzone.classList.add('file-selected');
    });

    dropzone.addEventListener('dragleave', (e) => {
        e.preventDefault();
        if (!selectedFile) {
            dropzone.classList.remove('file-selected');
        }
    });

    dropzone.addEventListener('drop', (e) => {
        e.preventDefault();
        const file = e.dataTransfer.files[0];
        handleFile(file);
    });

    // Handle file
    function handleFile(file) {
        if (!file) return;

        // Validate file type
        const validTypes = ['text/csv', 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'];
        if (!validTypes.includes(file.type) && !file.name.endsWith('.csv') && !file.name.endsWith('.xlsx')) {
            alert('Please upload a valid CSV or XLSX file');
            return;
        }

        // Validate file size (10MB max)
        const maxSize = 10 * 1024 * 1024; // 10MB
        if (file.size > maxSize) {
            alert('File size must be less than 10MB');
            return;
        }

        selectedFile = file;
        
        // Update UI
        fileName.textContent = file.name;
        fileSize.textContent = formatFileSize(file.size);
        fileInfo.classList.remove('hidden');
        dropzone.classList.add('file-selected');
        analyzeBtn.disabled = false;
    }

    // Remove file
    removeFileBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        selectedFile = null;
        fileInput.value = '';
        fileInfo.classList.add('hidden');
        dropzone.classList.remove('file-selected');
        analyzeBtn.disabled = true;
    });

    // Analyze button click
    analyzeBtn.addEventListener('click', async () => {
        if (!selectedFile) return;

        // Show loading state
        analyzeBtn.disabled = true;
        analyzeBtn.innerHTML = '<span class="truncate">Analyzing...</span><span class="material-symbols-outlined animate-spin">progress_activity</span>';

        // Create FormData
        const formData = new FormData();
        formData.append('file', selectedFile);

        try {
            // Send to backend
            const response = await fetch('/api/analyze', {
                method: 'POST',
                body: formData,
                headers: {
                    'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
            });

            if (!response.ok) {
                throw new Error('Analysis failed');
            }

            const result = await response.json();
            
            // Redirect to results page with analysis ID
            window.location.href = `results.html?id=${result.analysis_id}`;

        } catch (error) {
            console.error('Error:', error);
            alert('An error occurred during analysis. Please try again.');  
            
            // Reset button
            analyzeBtn.disabled = false;
            analyzeBtn.innerHTML = '<span class="truncate">Upload and Analyze</span><span class="material-symbols-outlined">bolt</span>';
        }
    });

    // Helper function to format file size
    function formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
    }
</script>
</body></html>